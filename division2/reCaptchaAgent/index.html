<!DOCTYPE html>
<html>

<head>
    <title>reCaptchaAgent</title>
    <link rel="stylesheet" href="reCaptchaAgent.css">
</head>

<body>
    <div class='wrapper'>
        <div id="rc-imageselect">
            <div class="rc-imageselect-response-field"></div><span class="rc-imageselect-tabloop-begin"
                tabindex="0"></span>
            <div class="rc-imageselect-payload">
                <div class="rc-imageselect-instructions">
                    <div class="rc-imageselect-desc-wrapper">
                        <div class="rc-imageselect-desc-no-canonical" style="width: 352px; font-size: 16px;">
                            please select all squares with
                            <strong style="font-size: 26px;">Core Attribute : <span
                                style="font-size: 26px; display: inline;" id="condition"></span></strong>
                            </div>
                    </div>
                    <div class="rc-imageselect-progress"></div>
                </div>
                <div class="rc-imageselect-challenge">
                    <div id="rc-imageselect-target" class="rc-imageselect-target" dir="ltr" role="presentation"
                        aria-hidden="true">
                        <table class="rc-imageselect-table-44">
                            <tbody>
                                <tr>
                                    <td role="button" tabindex="4" class="rc-imageselect-tile" aria-label="確認用画像">
                                        <div class="rc-image-tile-target">
                                            <div class="rc-image-tile-wrapper" style="width: 95px; height: 95px"><img id='img00'
                                                    class="rc-image-tile-44"
                                                    src="../svg/防具_ブランド/5.11Tactical_w.svg"
                                                    alt="">
                                                <div class="rc-image-tile-overlay"></div>
                                            </div>
                                            <div class="rc-imageselect-checkbox"></div>
                                        </div>
                                    </td>
                                    <td role="button" tabindex="5" class="rc-imageselect-tile" aria-label="確認用画像">
                                        <div class="rc-image-tile-target">
                                            <div class="rc-image-tile-wrapper" style="width: 95px; height: 95px"><img id='img01'
                                                    class="rc-image-tile-44"
                                                    src="../svg/防具_ブランド/アイラルディホールディングス_w.svg"
                                                    alt="">
                                                <div class="rc-image-tile-overlay"></div>
                                            </div>
                                            <div class="rc-imageselect-checkbox"></div>
                                        </div>
                                    </td>
                                    <td role="button" tabindex="6" class="rc-imageselect-tile" aria-label="確認用画像">
                                        <div class="rc-image-tile-target">
                                            <div class="rc-image-tile-wrapper" style="width: 95px; height: 95px"><img id='img02'
                                                    class="rc-image-tile-44"
                                                    src="../svg/防具_ブランド/ウォーカー・ハリス社_w.svg"
                                                    alt="">
                                                <div class="rc-image-tile-overlay"></div>
                                            </div>
                                            <div class="rc-imageselect-checkbox"></div>
                                        </div>
                                    </td>
                                    <td role="button" tabindex="7" class="rc-imageselect-tile" aria-label="確認用画像">
                                        <div class="rc-image-tile-target">
                                            <div class="rc-image-tile-wrapper" style="width: 95px; height: 95px"><img id='img03'
                                                    class="rc-image-tile-44"
                                                    src="../svg/防具_ブランド/ソコロフ社_w.svg"
                                                    alt="">
                                                <div class="rc-image-tile-overlay"></div>
                                            </div>
                                            <div class="rc-imageselect-checkbox"></div>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td role="button" tabindex="8" class="rc-imageselect-tile" aria-label="確認用画像">
                                        <div class="rc-image-tile-target">
                                            <div class="rc-image-tile-wrapper" style="width: 95px; height: 95px"><img id='img10'
                                                    class="rc-image-tile-44"
                                                    src="../svg/防具_ブランド/ムラカミインダストリーズ_w.svg"
                                                    alt="">
                                                <div class="rc-image-tile-overlay"></div>
                                            </div>
                                            <div class="rc-imageselect-checkbox"></div>
                                        </div>
                                    </td>
                                    <td role="button" tabindex="9" class="rc-imageselect-tile" aria-label="確認用画像">
                                        <div class="rc-image-tile-target">
                                            <div class="rc-image-tile-wrapper" style="width: 95px; height: 95px"><img id='img11'
                                                    class="rc-image-tile-44"
                                                    src=""
                                                    alt="">
                                                <div class="rc-image-tile-overlay"></div>
                                            </div>
                                            <div class="rc-imageselect-checkbox"></div>
                                        </div>
                                    </td>
                                    <td role="button" tabindex="10" class="rc-imageselect-tile" aria-label="確認用画像">
                                        <div class="rc-image-tile-target">
                                            <div class="rc-image-tile-wrapper" style="width: 95px; height: 95px"><img id='img12'
                                                    class="rc-image-tile-44"
                                                    src=""
                                                    alt="">
                                                <div class="rc-image-tile-overlay"></div>
                                            </div>
                                            <div class="rc-imageselect-checkbox"></div>
                                        </div>
                                    </td>
                                    <td role="button" tabindex="11" class="rc-imageselect-tile" aria-label="確認用画像">
                                        <div class="rc-image-tile-target">
                                            <div class="rc-image-tile-wrapper" style="width: 95px; height: 95px"><img id='img13'
                                                    class="rc-image-tile-44"
                                                    src=""
                                                    alt="">
                                                <div class="rc-image-tile-overlay"></div>
                                            </div>
                                            <div class="rc-imageselect-checkbox"></div>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td role="button" tabindex="12" class="rc-imageselect-tile" aria-label="確認用画像">
                                        <div class="rc-image-tile-target">
                                            <div class="rc-image-tile-wrapper" style="width: 95px; height: 95px"><img id='img20'
                                                    class="rc-image-tile-44"
                                                    src=""
                                                    alt="">
                                                <div class="rc-image-tile-overlay"></div>
                                            </div>
                                            <div class="rc-imageselect-checkbox"></div>
                                        </div>
                                    </td>
                                    <td role="button" tabindex="13" class="rc-imageselect-tile" aria-label="確認用画像">
                                        <div class="rc-image-tile-target">
                                            <div class="rc-image-tile-wrapper" style="width: 95px; height: 95px"><img id='img21'
                                                    class="rc-image-tile-44"
                                                    src=""
                                                    alt="">
                                                <div class="rc-image-tile-overlay"></div>
                                            </div>
                                            <div class="rc-imageselect-checkbox"></div>
                                        </div>
                                    </td>
                                    <td role="button" tabindex="14" class="rc-imageselect-tile" aria-label="確認用画像">
                                        <div class="rc-image-tile-target">
                                            <div class="rc-image-tile-wrapper" style="width: 95px; height: 95px"><img id='img22'
                                                    class="rc-image-tile-44"
                                                    src=""
                                                    alt="">
                                                <div class="rc-image-tile-overlay"></div>
                                            </div>
                                            <div class="rc-imageselect-checkbox"></div>
                                        </div>
                                    </td>
                                    <td role="button" tabindex="15" class="rc-imageselect-tile" aria-label="確認用画像">
                                        <div class="rc-image-tile-target">
                                            <div class="rc-image-tile-wrapper" style="width: 95px; height: 95px"><img id='img23'
                                                    class="rc-image-tile-44"
                                                    src=""
                                                    alt="">
                                                <div class="rc-image-tile-overlay"></div>
                                            </div>
                                            <div class="rc-imageselect-checkbox"></div>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td role="button" tabindex="16" class="rc-imageselect-tile" aria-label="確認用画像">
                                        <div class="rc-image-tile-target">
                                            <div class="rc-image-tile-wrapper" style="width: 95px; height: 95px"><img id='img30'
                                                    class="rc-image-tile-44"
                                                    src=""
                                                    alt="">
                                                <div class="rc-image-tile-overlay"></div>
                                            </div>
                                            <div class="rc-imageselect-checkbox"></div>
                                        </div>
                                    </td>
                                    <td role="button" tabindex="17" class="rc-imageselect-tile" aria-label="確認用画像">
                                        <div class="rc-image-tile-target">
                                            <div class="rc-image-tile-wrapper" style="width: 95px; height: 95px"><img id='img31'
                                                    class="rc-image-tile-44"
                                                    src=""
                                                    alt="">
                                                <div class="rc-image-tile-overlay"></div>
                                            </div>
                                            <div class="rc-imageselect-checkbox"></div>
                                        </div>
                                    </td>
                                    <td role="button" tabindex="18" class="rc-imageselect-tile" aria-label="確認用画像">
                                        <div class="rc-image-tile-target">
                                            <div class="rc-image-tile-wrapper" style="width: 95px; height: 95px"><img id='img32'
                                                    class="rc-image-tile-44"
                                                    src=""
                                                    alt="">
                                                <div class="rc-image-tile-overlay"></div>
                                            </div>
                                            <div class="rc-imageselect-checkbox"></div>
                                        </div>
                                    </td>
                                    <td role="button" tabindex="19" class="rc-imageselect-tile" aria-label="確認用画像">
                                        <div class="rc-image-tile-target">
                                            <div class="rc-image-tile-wrapper" style="width: 95px; height: 95px"><img id='img33'
                                                    class="rc-image-tile-44"
                                                    src=""
                                                    alt="">
                                                <div class="rc-image-tile-overlay"></div>
                                            </div>
                                            <div class="rc-imageselect-checkbox"></div>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="rc-imageselect-incorrect-response" style="display:none">もう一度お試しください。</div>
                <div aria-live="polite">
                    <div class="rc-imageselect-error-select-more" style="display:none">該当する画像をすべて選択してください。</div>
                    <div class="rc-imageselect-error-dynamic-more" style="display:none">新しい画像もご確認ください。</div>
                    <div class="rc-imageselect-error-select-something" style="display:none">
                        対象物を選択してください。何も表示されない場合は、再読み込みしてください。</div>
                </div>
            </div>
            <div class="rc-footer">
                <div class="rc-separator"></div>
                <div class="rc-controls">
                    <div class="primary-controls">
                        <div class="rc-buttons">
                            <div class="button-holder reload-button-holder"><button
                                    class="rc-button goog-inline-block rc-button-reload" title="別の画像を表示" value=""
                                    id="recaptcha-reload-button" tabindex="3"></button></div>
                            <div class="button-holder audio-button-holder"><button
                                    class="rc-button goog-inline-block rc-button-audio" title="確認用の文字を音声として聞く" value=""
                                    id="recaptcha-audio-button" tabindex="1"></button></div>
                            <div class="button-holder image-button-holder"><button
                                    class="rc-button goog-inline-block rc-button-image" title="確認用の文字を画像として表示" value=""
                                    id="recaptcha-image-button" tabindex="0" style="display: none;"></button></div>
                            <div class="button-holder help-button-holder"><button
                                    class="rc-button goog-inline-block rc-button-help" title="ヘルプ" value=""
                                    id="recaptcha-help-button" tabindex="2"></button></div>
                            <div class="button-holder undo-button-holder"><button
                                    class="rc-button goog-inline-block rc-button-undo" title="取消" value=""
                                    id="recaptcha-undo-button" tabindex="0" style="display: none;"></button></div>
                        </div>
                        <div class="verify-button-holder"><button class="rc-button-default goog-inline-block" title=""
                                value="" id="recaptcha-verify-button" tabindex="0">Give up</button></div>
                    </div>
                    <div class="rc-challenge-help" style="display:none" tabindex="0"></div>
                </div>
            </div><span class="rc-imageselect-tabloop-end" tabindex="0"></span>
        </div>
    </div>

    <script>
        condition = [
            "Armor",
            "Weapon",
            "Skill",
        ]

        gear = [
            "img/Armor/5.11Tactical_w.svg",
            "img/Armor/ギラ・ガード_w.svg",
            "img/Armor/ゴラン・ギア_w.svg",
            "img/Armor/バッジャー・タフ_w.svg",
            "img/Armor/ベルストーンアーマリー_w.svg",
            "img/Armor/ヤールギア_w.svg",
            "img/Weapon/オーバーロード・アーマメント_w.svg",
            "img/Weapon/グルーポソンブラ社_w.svg",
            "img/Weapon/ソコロフ社_w.svg",
            "img/Weapon/ダグラス＆ハーディング_w.svg",
            "img/Weapon/チェスカ・ヴィーロパ社_w.svg",
            "img/Weapon/フェンリスグループ社_w.svg",
            "img/Weapon/プロビデンスディフェンス_w.svg",
            "img/Weapon/ペトロフ・ディフェンス・グループ_w.svg",
            "img/Weapon/アイラルディホールディングス_w.svg",
            "img/Weapon/ウォーカー・ハリス社_w.svg",
            "img/Skill/エンプレス・インターナショナル_w.svg",
            "img/Skill/チャイナ・ライトインダストリー社_w.svg",
            "img/Skill/ハナウコーポレーション_w.svg",
            "img/Skill/ムラカミインダストリーズ_w.svg",
            "img/Skill/リヒター＆カイザー社_w.svg",
            "img/Skill/ワイバーンウェア_w.svg",
            "img/Skill/アルプスサミット・アーマメント_w.svg",
        ]

        function shuffleArray(inputArray){
            inputArray.sort(()=> Math.random() - 0.5);
        }

        function resetImgs() {
            shuffleArray(gear);
            shuffleArray(condition);
            document.getElementById("condition").innerText = condition[0];
            let idx = 0;
            for (let r = 0; r < 4; r++){
                for (let c = 0; c < 4; c++){
                    let id = `img${r}${c}`;
                    let img = document.getElementById(id);
                    img.src = gear[idx++];
                    img.classList = ['rc-image-tile-44'];
                }
            }
        }

        window.onload = () => {
            resetImgs();
        }

        function imgClick(e){
            if (this.classList.length == 1) {
                console.log('click')
            } else {
                console.log('already clicked')
                return
            }

            if (this.src.match(/Armor/)) {
                console.log("Armor");
                this.classList.add("Armor")
            }
            else if (this.src.match(/Weapon/)) {
                console.log("Weapon");
                this.classList.add("Weapon")
            }
            else if (this.src.match(/Skill/)) {
                console.log("Skill");
                this.classList.add("Skill")
            }

            let result = judge()

            console.log('reseult', result)

            if (result < 0){
                giveupImgs()
                alert("You're Rogue Agent!!")
            } else if (result > 0) {
                // game clear
                alert('Congrats Agent!!')
                conguratsImgs()
            }
        }

        function judge(){

            let correct = document.getElementById("condition").innerText;
            let cnt_ok = 0;
            let cnt_ng = 0;
            let cnt_total = 0;

            for (let r = 0; r < 4; r++){
                for (let c = 0; c < 4; c++){
                    let id = `img${r}${c}`;
                    if (document.getElementById(id).classList.length > 1) {
                        // clicked
                        if (Array.from(document.getElementById(id).classList).includes(correct)) {
                            cnt_ok++;
                        } else {
                            cnt_ng++;
                        }
                    }
                    if (document.getElementById(id).src.match(correct)) {
                        cnt_total++;
                    }
                }
            }

            console.log(cnt_total, cnt_ok, cnt_ng);

            if (cnt_ng > 0){
                return -1;
            } else if (cnt_total == cnt_ok){
                return 1;
            } else {
                return 0;
            }
        }

        function giveupImgs(){
            for (let r = 0; r < 4; r++){
                for (let c = 0; c < 4; c++){
                    let id = `img${r}${c}`;
                    let img = document.getElementById(id);

                    if (img.classList.length == 1) {
                        if (img.src.match(/Armor/)) {
                            img.classList.add("Armor")
                        }
                        else if (img.src.match(/Weapon/)) {
                            img.classList.add("Weapon")
                        }
                        else if (img.src.match(/Skill/)) {
                            img.classList.add("Skill")
                        }
                    }
                }
            }
        }

        function conguratsImgs(){
            for (let r = 0; r < 4; r++){
                for (let c = 0; c < 4; c++){
                    let id = `img${r}${c}`;
                    let img = document.getElementById(id);

                    if (img.classList.length == 1) {
                        img.classList.add("Congrats")
                    }
                }
            }
        }

        let imgs = document.getElementsByClassName("rc-image-tile-44");
        Array.from(imgs).forEach(d => d.addEventListener("click", imgClick));

        let reload = document.getElementById("recaptcha-reload-button");
        reload.addEventListener("click", resetImgs)

        let giveup = document.getElementById("recaptcha-verify-button");
        giveup.addEventListener("click", giveupImgs)
        
    </script>

</body>
</html>